<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>jkwarthegarden</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://jkwarthegarden.com/"/>
  <updated>2017-04-06T11:35:23.000Z</updated>
  <id>http://jkwarthegarden.com/</id>
  
  <author>
    <name>JKwar</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Android Studio Gradle 第三方依赖统一管理的几种方式</title>
    <link href="http://jkwarthegarden.com/2017/04/06/Android%20Studio%20Gradle%E7%AC%AC%E4%B8%89%E4%BE%9D%E8%B5%96%E7%BB%9F%E4%B8%80%E7%AE%A1%E7%90%86/"/>
    <id>http://jkwarthegarden.com/2017/04/06/Android Studio Gradle第三依赖统一管理/</id>
    <published>2017-04-06T11:33:00.000Z</published>
    <updated>2017-04-06T11:35:23.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="第一种方式"><a href="#第一种方式" class="headerlink" title="第一种方式"></a>第一种方式</h3><p>假设你的 Project 结构如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">root</div><div class="line">  --module1</div><div class="line">    --build.gradle</div><div class="line">  --module2</div><div class="line">    --build.gradle</div><div class="line">  ...</div><div class="line">  --build.gradle</div></pre></td></tr></table></figure></p>
<a id="more"></a>  
<p>###使用脚本 config.gradle<br>为了方便管理，可以在根目录下新建 config.gradle 文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">root</div><div class="line">  --module1</div><div class="line">    --build.gradle</div><div class="line">  --module2</div><div class="line">    --build.gradle</div><div class="line">  ...</div><div class="line">  --build.gradle</div><div class="line">  --config.gradle</div></pre></td></tr></table></figure></p>
<p>在 config.gradle 中添加如下代码（具体情况根据自己项目来定）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">ext &#123;</div><div class="line">    kotlin_version = &apos;1.1.0&apos;</div><div class="line"></div><div class="line">    android = [</div><div class="line">            compileSdkVersion: 25,</div><div class="line">            buildToolsVersion: &quot;25.0.2&quot;,</div><div class="line">            applicationId    : &quot;com.jkwar.TomatoWork&quot;,</div><div class="line">            minSdkVersion    : 15,</div><div class="line">            targetSdkVersion : 25,</div><div class="line">            versionCode      : 1,</div><div class="line">            versionName      : &quot;1.0&quot;</div><div class="line">    ]</div><div class="line"></div><div class="line">    dependencies = [</div><div class="line">            &quot;kotlin-stdlib&quot;       : &quot;org.jetbrains.kotlin:kotlin-stdlib-jre7:$kotlin_version&quot;,</div><div class="line">            &quot;appcompat-v7&quot;        : &quot;com.android.support:appcompat-v7:25.3.1&quot;,</div><div class="line">            &quot;constraint-layout&quot;   : &quot;com.android.support.constraint:constraint-layout:1.0.2&quot;,</div><div class="line">            &quot;rxjava&quot;              : &quot;io.reactivex.rxjava2:rxjava:2.0.8&quot;,</div><div class="line">            &quot;rxandroid&quot;           : &quot;io.reactivex.rxjava2:rxandroid:2.0.1&quot;,</div><div class="line">            &quot;retrofit&quot;            : &quot;com.squareup.retrofit2:retrofit:2.2.0&quot;,</div><div class="line">            &quot;gson&quot;                : &quot;com.google.code.gson:gson:2.6.2&quot;,</div><div class="line">            &quot;converter-gson&quot;      : &quot;com.squareup.retrofit2:converter-gson:2.2.0&quot;,</div><div class="line">            &quot;adapter-rxjava&quot;      : &quot;com.squareup.retrofit2:adapter-rxjava2:2.2.0&quot;,</div><div class="line">            &quot;logging-interceptor&quot; : &quot;com.squareup.okhttp3:logging-interceptor:3.6.0&quot;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在 root 目录下的build.gradle 中加上apply from: “config.gradle”<br><img src="http://oglc61v4u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-04-06%2019.09.53.png" alt=""></p>
<p>在需要添加依赖的 Module 中使用</p>
<ul>
<li>android 节点的使用<br><img src="http://oglc61v4u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-04-06%2019.11.33.png" alt=""></li>
<li>dependencies 节点的使用<br><img src="http://oglc61v4u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-04-06%2019.11.24.png" alt=""></li>
</ul>
<h3 id="第二种方式"><a href="#第二种方式" class="headerlink" title="第二种方式"></a>第二种方式</h3><p>不新建config.gradle 文件，使用跟目录下的build.gradle文件。</p>
<h3 id="第三种方式"><a href="#第三种方式" class="headerlink" title="第三种方式"></a>第三种方式</h3><p>使用配置文件 gradle.properties（通常 IDE 会自动生成此文件），在此文件中添加键值对：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rxjava=io.reactivex.rxjava2:rxjava:2.0.8</div><div class="line">rxandroid=io.reactivex.rxjava2:rxandroid:2.0.1</div></pre></td></tr></table></figure></p>
<p>在 Module 的 build.gradle 中使用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dependencies &#123;</div><div class="line">    compile rxjava</div><div class="line">    compile rxandroid</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;第一种方式&quot;&gt;&lt;a href=&quot;#第一种方式&quot; class=&quot;headerlink&quot; title=&quot;第一种方式&quot;&gt;&lt;/a&gt;第一种方式&lt;/h3&gt;&lt;p&gt;假设你的 Project 结构如下：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;root&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  --module1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    --build.gradle&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  --module2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    --build.gradle&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  ...&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  --build.gradle&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Android Studio" scheme="http://jkwarthegarden.com/categories/Android-Studio/"/>
    
    
      <category term="Gradle" scheme="http://jkwarthegarden.com/tags/Gradle/"/>
    
  </entry>
  
  <entry>
    <title>Android 启动Java8的lambad表达式</title>
    <link href="http://jkwarthegarden.com/2016/05/20/Android%20%E5%90%AF%E7%94%A8Java8%E7%9A%84lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <id>http://jkwarthegarden.com/2016/05/20/Android 启用Java8的lambda表达式/</id>
    <published>2016-05-20T07:37:59.000Z</published>
    <updated>2017-04-19T07:38:59.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="添加到project的build-gradle中。"><a href="#添加到project的build-gradle中。" class="headerlink" title="添加到project的build.gradle中。"></a>添加到project的build.gradle中。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">buildscript &#123;</div><div class="line">   repositories &#123;</div><div class="line">      mavenCentral()</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   dependencies &#123;</div><div class="line">      classpath &apos;me.tatarka:gradle-retrolambda:3.6.0&apos;</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">// Required because retrolambda is on maven central</div><div class="line">repositories &#123;</div><div class="line">   mavenCentral()</div><div class="line">&#125;</div><div class="line"></div><div class="line">apply plugin: &apos;com.android.application&apos; //or apply plugin: &apos;java&apos;</div><div class="line">apply plugin: &apos;me.tatarka.retrolambda&apos;</div></pre></td></tr></table></figure>
<a id="more"></a>  
<h4 id="设置java版本。"><a href="#设置java版本。" class="headerlink" title="设置java版本。"></a>设置java版本。</h4><p>在build.gradle的android节点下添加：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">  compileOptions &#123;</div><div class="line">    //设置java版本</div><div class="line">    sourceCompatibility JavaVersion.VERSION_1_8</div><div class="line">    targetCompatibility JavaVersion.VERSION_1_8</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="对项目进行build。"><a href="#对项目进行build。" class="headerlink" title="对项目进行build。"></a>对项目进行build。</h4>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;添加到project的build-gradle中。&quot;&gt;&lt;a href=&quot;#添加到project的build-gradle中。&quot; class=&quot;headerlink&quot; title=&quot;添加到project的build.gradle中。&quot;&gt;&lt;/a&gt;添加到project的build.gradle中。&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;buildscript &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   repositories &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      mavenCentral()&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   dependencies &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;      classpath &amp;apos;me.tatarka:gradle-retrolambda:3.6.0&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;// Required because retrolambda is on maven central&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;repositories &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   mavenCentral()&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;apply plugin: &amp;apos;com.android.application&amp;apos; //or apply plugin: &amp;apos;java&amp;apos;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;apply plugin: &amp;apos;me.tatarka.retrolambda&amp;apos;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="lambad" scheme="http://jkwarthegarden.com/categories/lambad/"/>
    
    
      <category term="lambad" scheme="http://jkwarthegarden.com/tags/lambad/"/>
    
  </entry>
  
  <entry>
    <title>Android 导航栏和状态栏操作</title>
    <link href="http://jkwarthegarden.com/2016/04/12/Android%20%E5%AF%BC%E8%88%AA%E6%A0%8F%E5%92%8C%E7%8A%B6%E6%80%81%E6%A0%8F%E6%93%8D%E4%BD%9C/"/>
    <id>http://jkwarthegarden.com/2016/04/12/Android 导航栏和状态栏操作/</id>
    <published>2016-04-11T17:34:14.000Z</published>
    <updated>2017-03-28T19:58:26.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="淡化状态栏和系统栏"><a href="#淡化状态栏和系统栏" class="headerlink" title="淡化状态栏和系统栏"></a>淡化状态栏和系统栏</h3><blockquote>
<p>在版本为4.0以上的Android系统上,可以使用 SYSTEM_UI_FLAG_LOW_PROFILE 这个标签</p>
</blockquote>
<p>  <code>decorView.setSystemUiVisibility(View.SYSTEM_UI_FLAG_LOW_PROFILE);</code></p>
<a id="more"></a>  
<h3 id="显示状态栏与导航栏"><a href="#显示状态栏与导航栏" class="headerlink" title="显示状态栏与导航栏"></a>显示状态栏与导航栏</h3><p>  <code>decorView.setSystemUiVisibility(0);</code></p>
<h3 id="隐藏状态栏"><a href="#隐藏状态栏" class="headerlink" title="隐藏状态栏"></a>隐藏状态栏</h3><ol>
<li><p>在4.0及以下版本中隐藏状态栏有2种方法</p>
<ol>
<li>在你的manifest文件中设置Activity的主题<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;application</div><div class="line">  android:theme=&quot;@android:style/Theme.Holo.NoActionBar.Fullscreen&quot; &gt;</div><div class="line">&lt;/application&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>设置主题的优势是:<br>易于维护，且不像动态设置标签那样容易出错。<br>有更流畅的UI转换，因为在初始化你的Activity之前,系统已经得到了需要渲染UI的信息。</p>
</blockquote>
<ol>
<li>使用WindowManager来动态隐藏状态栏<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public class MainActivity extends Activity &#123;</div><div class="line"> @Override</div><div class="line"> protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">     super.onCreate(savedInstanceState);</div><div class="line">     if (Build.VERSION.SDK_INT &lt; 16) &#123;</div><div class="line">         getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,</div><div class="line">                 WindowManager.LayoutParams.FLAG_FULLSCREEN);</div><div class="line">     &#125;</div><div class="line">     setContentView(R.layout.activity_main);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>在4.1及以上版本中隐藏状态栏。<br>使用 setSystemUiVisibility() 进行动态隐藏</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">View decorView = getWindow().getDecorView();</div><div class="line">int uiOptions = View.SYSTEM_UI_FLAG_FULLSCREEN;</div><div class="line">decorView.setSystemUiVisibility(uiOptions);</div><div class="line">ActionBar actionBar = getActionBar();</div><div class="line">actionBar.hide();</div></pre></td></tr></table></figure>
</li>
<li><p>让内容显示在状态栏之后。</p>
<blockquote>
<p>使用 SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN 标签<br>并在xml 中使用android:fitsSystemWindows=”true”,<br>它会调整父ViewGroup使它留出特定区域给系统栏,确保应用中特定区域不会被系统栏掩盖。</p>
</blockquote>
</li>
</ol>
<h3 id="隐藏导航栏"><a href="#隐藏导航栏" class="headerlink" title="隐藏导航栏"></a>隐藏导航栏</h3><ol>
<li><p>在4.0及以上版本中隐藏导航栏</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">View decorView = getWindow().getDecorView();</div><div class="line">int uiOptions = View.SYSTEM_UI_FLAG_HIDE_NAVIGATION</div><div class="line">             | View.SYSTEM_UI_FLAG_FULLSCREEN;</div><div class="line">decorView.setSystemUiVisibility(uiOptions);</div></pre></td></tr></table></figure>
</li>
<li><p>让内容显示在导航栏之后</p>
<blockquote>
<p>使用 SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION 标签</p>
</blockquote>
<ul>
<li>要注意的几点:</li>
<li>一旦UI标签被清除就必须重新设置(比如跳到另外一个Activity)。</li>
<li>在不同地方监听UI标签是有所不同的,比如在Activity的onCreate()方法中隐藏状态      栏,当用户按下home键系统栏就会重新显示,如果你想让在不同Activity之间切换,系统UI保持不变，你需要在onResume()与onWindowFocusChaned()里设定UI标签。</li>
<li>setSystemUiVisibility()仅仅在被调用的View显示的时候才会生效。</li>
<li>当从View导航到别的地方时，用setSystemUiVisibility()设置的标签会被清除。</li>
</ul>
</li>
</ol>
<h3 id="全屏沉浸式应用"><a href="#全屏沉浸式应用" class="headerlink" title="全屏沉浸式应用"></a>全屏沉浸式应用</h3><p> 使用非粘性沉浸模式<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mDecorView.setSystemUiVisibility(</div><div class="line">           View.SYSTEM_UI_FLAG_LAYOUT_STABLE</div><div class="line">           | View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION</div><div class="line">           | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN</div><div class="line">           | View.SYSTEM_UI_FLAG_HIDE_NAVIGATION // 隐藏导航栏</div><div class="line">           | View.SYSTEM_UI_FLAG_FULLSCREEN // 隐藏状态栏</div><div class="line">           | View.SYSTEM_UI_FLAG_IMMERSIVE);</div></pre></td></tr></table></figure></p>
<p> 使用粘性沉浸模式<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">decorView.setSystemUiVisibility(</div><div class="line">               View.SYSTEM_UI_FLAG_LAYOUT_STABLE</div><div class="line">               | View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION</div><div class="line">               | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN</div><div class="line">               | View.SYSTEM_UI_FLAG_HIDE_NAVIGATION</div><div class="line">               | View.SYSTEM_UI_FLAG_FULLSCREEN</div><div class="line">               | View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY);</div></pre></td></tr></table></figure></p>
<p> 注意沉浸式只能在android 4.4以上的系统使用</p>
<h3 id="响应UI可见性的变化"><a href="#响应UI可见性的变化" class="headerlink" title="响应UI可见性的变化"></a>响应UI可见性的变化</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">decorView.setOnSystemUiVisibilityChangeListener</div><div class="line">   (new View.OnSystemUiVisibilityChangeListener() &#123;</div><div class="line">    @Override</div><div class="line">    public void onSystemUiVisibilityChange(int visibility) &#123;</div><div class="line">        //全屏</div><div class="line">        if ((visibility &amp; View.SYSTEM_UI_FLAG_FULLSCREEN) == 0) &#123;</div><div class="line">        </div><div class="line">        &#125; else &#123;</div><div class="line">        </div><div class="line">        &#125;</div><div class="line">     &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;淡化状态栏和系统栏&quot;&gt;&lt;a href=&quot;#淡化状态栏和系统栏&quot; class=&quot;headerlink&quot; title=&quot;淡化状态栏和系统栏&quot;&gt;&lt;/a&gt;淡化状态栏和系统栏&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;在版本为4.0以上的Android系统上,可以使用 SYSTEM_UI_FLAG_LOW_PROFILE 这个标签&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;  &lt;code&gt;decorView.setSystemUiVisibility(View.SYSTEM_UI_FLAG_LOW_PROFILE);&lt;/code&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Android 视图" scheme="http://jkwarthegarden.com/categories/Android-%E8%A7%86%E5%9B%BE/"/>
    
    
      <category term="状态栏,导航栏" scheme="http://jkwarthegarden.com/tags/%E7%8A%B6%E6%80%81%E6%A0%8F-%E5%AF%BC%E8%88%AA%E6%A0%8F/"/>
    
  </entry>
  
  <entry>
    <title>Android 半通明状态栏</title>
    <link href="http://jkwarthegarden.com/2016/04/08/Android%20%E5%8D%8A%E9%80%9A%E6%98%8E%E7%8A%B6%E6%80%81%E6%A0%8F/"/>
    <id>http://jkwarthegarden.com/2016/04/08/Android 半通明状态栏/</id>
    <published>2016-04-07T16:45:00.000Z</published>
    <updated>2017-03-28T19:58:24.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>Android 从4.4 版本开始支持半透明状态栏效果。<br>4.4设置方式与5.0不同(5.0推出了Material Design,不用设置默认就有)。<br>在4.4 设置半通明状态栏效果,有2种方法。</p>
</blockquote>
<a id="more"></a>  
<h4 id="第一种方案"><a href="#第一种方案" class="headerlink" title="第一种方案"></a>第一种方案</h4><ol>
<li><p>在代码中设置透明化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123;</div><div class="line">    WindowManager.LayoutParams localLayoutParams = getWindow().getAttributes();</div><div class="line">    localLayoutParams.flags = (WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS |            localLayoutParams.flags);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>使布局扩展至系统状态栏,状态栏会覆盖在toolbar上。</p>
</li>
<li><p>在根布局中添加<br><code>android:paddingTop=&quot;@dimen/toolbar_padding_top&quot;</code><br>在values中的dimens文件里设为0dp,在values-v19的styles里设为25dp。</p>
</li>
</ol>
<h4 id="第二种方案"><a href="#第二种方案" class="headerlink" title="第二种方案"></a>第二种方案</h4><ol>
<li>在代码中设置透明化<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123;</div><div class="line">    WindowManager.LayoutParams localLayoutParams = getWindow().getAttributes();    </div><div class="line">    localLayoutParams.flags = (WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS|             localLayoutParams.flags);</div><div class="line">    if (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.LOLLIPOP) &#123;</div><div class="line">         //设置边距</div><div class="line">         view(根布局).setFitsSystemWindows(true);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Android 从4.4 版本开始支持半透明状态栏效果。&lt;br&gt;4.4设置方式与5.0不同(5.0推出了Material Design,不用设置默认就有)。&lt;br&gt;在4.4 设置半通明状态栏效果,有2种方法。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Android 视图" scheme="http://jkwarthegarden.com/categories/Android-%E8%A7%86%E5%9B%BE/"/>
    
    
      <category term="状态栏" scheme="http://jkwarthegarden.com/tags/%E7%8A%B6%E6%80%81%E6%A0%8F/"/>
    
  </entry>
  
  <entry>
    <title>Android TouchEvent事件传递机制</title>
    <link href="http://jkwarthegarden.com/2016/03/31/Android%20TouchEvent%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B6/"/>
    <id>http://jkwarthegarden.com/2016/03/31/Android TouchEvent事件传递机制/</id>
    <published>2016-03-31T09:10:39.000Z</published>
    <updated>2017-04-01T14:33:53.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Tounch相关的方法"><a href="#Tounch相关的方法" class="headerlink" title="Tounch相关的方法"></a>Tounch相关的方法</h3><table>
<thead>
<tr>
<th>方法名</th>
<th>方法作用</th>
<th>拥有类            </th>
</tr>
</thead>
<tbody>
<tr>
<td> dispatchTouchEvent()</td>
<td>分派event 调用下面2个方法，一般不重写</td>
<td>ViewGroup子类，非ViewGroup子类</td>
</tr>
<tr>
<td> onInterceptTouchEvent()</td>
<td>拦截event true 拦截   false 不拦截</td>
<td>ViewGroup子类                 </td>
</tr>
<tr>
<td> onTouchEvent()</td>
<td>处理event true 处理了 false 交给上级处理</td>
<td>ViewGroup子类，非ViewGroup子类</td>
</tr>
</tbody>
</table>
 <a id="more"></a>  
<h3 id="事件拦截是什么？"><a href="#事件拦截是什么？" class="headerlink" title="事件拦截是什么？"></a>事件拦截是什么？</h3><p>要了解触摸事件的拦截机制，首先要知道什么是触摸事件？触摸事件顾名思义就是捕获接触屏幕后产生的事件，当操作应用时，会产生多个事件，按下按钮、这是Acition_Down事件，滑动、是Action_MOVE事件，手抬起、是Aciton_UP事件。这些事件你重新onTounchEvent（MotionEventeven）方法，可以从MotionEvent中找到参数。如此，看来触摸事件还是比较简单的，但是Android的View结构是树形结构，ViewGroup可以包含View，另一个ViewGroup，甚至可能继续嵌套，一层层的叠起来，我们的触摸事件就只有一个，分给谁？父ViewGroup和子View，子ViewGroup到底哪个处理，于是就产生了事件拦截。</p>
<h3 id="事件拦截原理"><a href="#事件拦截原理" class="headerlink" title="事件拦截原理"></a>事件拦截原理</h3><p>举一个通俗的例子，假设：你所在的公司有一个总裁，级别最高，下面是部门经理，级别次之，最底层，就是干活的我。</p>
<ol>
<li>现在董事会交给一个任务给总裁。</li>
<li>总裁把这个任务安排给部长。</li>
<li>部长又把这个任务布置给我。</li>
<li>加班加点完成任务，交给部长。</li>
<li>部长感觉任务完成的不错，签名交给总裁。</li>
<li>总裁看了也感觉不错，汇报给董事会。<br>这就是一个完整的事件传递流程。</li>
</ol>
<p>总裁-MyViewGroupA，最外层的ViewGroup<br>部长-MyViewGroupB，中间层的ViewGroup<br>干活的我-MyView，  最底层的View</p>
<p>我们用一个实例来说明：<br>在ViewGroup中我们重写dispatchTouchEvent(),onInterceptTouchEvent(),onTouchEvent()方法，在View我们重写dispatchTouchEvent()，onTouchEvent() 方法。<br>这里可以看出ViewGroup的级别比较高，有onInterceptTouchEvent()这个事件拦截方法。</p>
<ol>
<li><p>首先我们点击View，log打印如下：<br><img src="http://oglc61v4u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-03-31%2016.30.21.png" alt=""><br>可以看出事件的传递顺序是：<br>总裁（MyViewGroupA）-&gt; 部长（MyViewGroupB）-&gt; 我（MyView）事件传递先执行dispatchTouchEvent()方法，在执行onInterceptTouchEvent()方法。<br>事件处理的顺序是：<br>我（MyView）-&gt; 部长（MyViewGroupA）-&gt; 总裁（MyViewGroupA）事件处理都执行的是onTouchEvent()方法。</p>
</li>
<li><p>总裁觉得这个任务太简单自己就能搞定，在onInterceptTouchEvent()中返回true将事件拦截掉，log打印如下：<br><img src="http://oglc61v4u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-03-31%2016.31.43.png" alt=""><br>和我们设想的一样，总裁一个人把事情干完了，下面的人就没事干了。</p>
</li>
<li><p>部长觉得总裁安排的任务太简单，没必麻烦我，log打印如下：<br><img src="http://oglc61v4u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-03-31%2016.37.28.png" alt=""><br>这次我（MyView）就不用干活了。</p>
</li>
<li><p>你每天处理完任务想上司报告，那天你受不了压迫，不想干了，自己罢工，在onTouchEvent()返回True，log打印如下：<br><img src="http://oglc61v4u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-03-31%2016.58.28.png" alt=""><br>事件传递还是跟以前一样，但是事件处理却在我（MyView）这里断掉了。</p>
<h5 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h5><p>(<a href="http://blog.csdn.net/morgan_xww/article/details/9372285" target="_blank" rel="external">http://blog.csdn.net/morgan_xww/article/details/9372285</a>)<br>(<a href="http://www.cnblogs.com/linjzong/p/4191891.html" target="_blank" rel="external">http://www.cnblogs.com/linjzong/p/4191891.html</a>)</p>
</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Tounch相关的方法&quot;&gt;&lt;a href=&quot;#Tounch相关的方法&quot; class=&quot;headerlink&quot; title=&quot;Tounch相关的方法&quot;&gt;&lt;/a&gt;Tounch相关的方法&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;方法名&lt;/th&gt;
&lt;th&gt;方法作用&lt;/th&gt;
&lt;th&gt;拥有类            &lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt; dispatchTouchEvent()&lt;/td&gt;
&lt;td&gt;分派event 调用下面2个方法，一般不重写&lt;/td&gt;
&lt;td&gt;ViewGroup子类，非ViewGroup子类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt; onInterceptTouchEvent()&lt;/td&gt;
&lt;td&gt;拦截event true 拦截   false 不拦截&lt;/td&gt;
&lt;td&gt;ViewGroup子类                 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt; onTouchEvent()&lt;/td&gt;
&lt;td&gt;处理event true 处理了 false 交给上级处理&lt;/td&gt;
&lt;td&gt;ViewGroup子类，非ViewGroup子类&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
    
    </summary>
    
      <category term="Android 视图" scheme="http://jkwarthegarden.com/categories/Android-%E8%A7%86%E5%9B%BE/"/>
    
    
      <category term="触摸事件" scheme="http://jkwarthegarden.com/tags/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>Android Paint 属性详解</title>
    <link href="http://jkwarthegarden.com/2016/01/19/Android%20Paint%20%E5%B1%9E%E6%80%A7%E8%AF%A6%E8%A7%A3/"/>
    <id>http://jkwarthegarden.com/2016/01/19/Android Paint 属性详解/</id>
    <published>2016-01-18T16:34:14.000Z</published>
    <updated>2017-03-28T19:58:28.000Z</updated>
    
    <content type="html"><![CDATA[<p>Paint即画笔,在绘图过程中起到了极其重要的作用,画笔主要保存了颜色，  </p>
<p>样式等绘制信息,指定了如何绘制文本和图形,画笔对象有很多设置方法，  </p>
<p>大体上可以分为两类,一类与图形绘制相关,一类与文本绘制相关. </p>
<a id="more"></a>
<h4 id="图形绘制"><a href="#图形绘制" class="headerlink" title="图形绘制"></a>图形绘制</h4><ol>
<li><p>设置Paint的标志<br>Paint.ANTI_ALIAS_FLAG 抗锯齿, Paint.FILTER_BITMAP_FLAG 位图过滤器,<br>Paint.DITHER_FLAG 防抖动,   Paint.UNDERLINE_TEXT_FLAG 启用下划线,<br>Paint.STRIKE_THRU_TEXT_FLAG 启用中划线, Paint.FAKE_BOLD_TEXT_FLAG 加粗文本<br>Paint.LINEAR_TEXT_FLAG 线性文本, Paint.SUBPIXEL_TEXT_FLAG 应用子像素抗锯齿效果<br>Paint.DEV_KERN_TEXT_FLAG 使用设备的文本字距。</p>
</li>
<li><p>设置绘制的颜色 a代表透明度，r，g，b代表颜色值。<br><code>setARGB(int a,int r,int g,int b);</code></p>
</li>
<li><p>设置a[0..255] 0：代表全透明  255代表不透明。<br><code>setAlpha(int a);</code></p>
</li>
<li><p>设置绘制的颜色,使用颜色值来表示,该颜色值包括透明度和RGB颜色。<br><code>setColor(int color)</code></p>
</li>
<li><p>设置是否使用抗锯齿功能,会消耗较大资源,绘制图形速度会变慢。<br><code>setAntiAlias(boolean aa);</code></p>
</li>
<li><p>设置是否使用图像抖动处理,会使绘制出来的图片颜色更加平滑和饱满,图像更加清晰。<br><code>setDither(boolean dither);</code></p>
</li>
<li><p>设置画笔的隐藏模式,INTING_OFF 或者 HINTING_ON。<br><code>setHinting(int mode)</code></p>
</li>
<li><p>如果该项设置为true,则图像在动画进行中会滤掉对Bitmap图像      的优化操作,加快显示速度,本设置项依赖于dither和xfermode的设置<br><code>setFilterBitmap(boolean filter);</code></p>
</li>
<li><p>设置MaskFilter,可以用不同的MaskFilter实现滤镜的效果,如滤化,立体等。<br><code>setMaskFilter(MaskFilter maskfilter);</code></p>
</li>
<li><p>设置颜色过滤器,可以在绘制颜色时实现不用颜色的变换效果。<br><code>setColorFilter(ColorFilter colorfilter);</code></p>
</li>
<li><p>设置绘制路径的效果,如点画线等。<br><code>setPathEffect(PathEffect effect);</code>  </p>
</li>
<li><p>设置图像效果,使用Shader可以绘制出各种渐变效果。<br><code>setShader(Shader shader);</code></p>
</li>
<li><p>在图形下面设置阴影层,产生阴影效果,radius为阴影的角度,dx和dy为阴影在x轴和y轴上的距离,       color为阴影的颜色。<br><code>setShadowLayer(float radius ,float dx,float dy,int color);</code></p>
</li>
<li><p>设置画笔的样式,为FILL 描边,FILL_OR_STROKE 描边并填充,或STROKE 填充。<br><code>setStyle(Paint.Style style);</code></p>
</li>
<li><p>设置画笔的笔触风格，如圆形样式Cap.ROUND,或方形样式Cap.SQUARE,默认是Paint.Cap.BUTT,也是方形样式。<br><code>setStrokeCap(Paint.Cap cap);</code></p>
</li>
<li><p>设置接合处的形态，如Join.MITER 锐角,Join.ROUND 圆弧,Join.BEVEL 直线。<br><code>setStrokeJoin(Paint.Join join);</code></p>
</li>
<li><p>设置笔画的倾斜度,取值：&gt;=0,设置笔触的连接处的样式,可以和setStrokeJoin()来比较。<br><code>setStrokeMiter(float miter )</code></p>
</li>
<li><p>设置画笔的粗细度。<br><code>setStrokeWidth(float width);</code></p>
</li>
</ol>
<h4 id="文本绘制"><a href="#文本绘制" class="headerlink" title="文本绘制"></a>文本绘制</h4><ol>
<li><p>模拟实现粗体文字，设置在小字体上效果会非常差。<br>‘setXfermode(Xfermode xfermode);’</p>
</li>
<li><p>设置该项为true，将有助于文本在LCD屏幕上的显示效果。<br><code>setSubpixelText(boolean subpixelText);</code></p>
</li>
<li><p>设置绘制文字的对齐方向。<br><code>setTextAlign(Paint.Align align);</code></p>
</li>
<li><p>设置绘制文字x轴的缩放比例，可以实现文字的拉伸的效果 。<br><code>setTextScaleX(float scaleX);</code></p>
</li>
<li><p>设置绘制文字的字号大小,设置值必须大于0。<br><code>setTextSize(float textSize);</code></p>
</li>
<li><p>设置斜体文字，skewX为倾斜弧度,值为右负左正,官方推崇的值为-0.25。<br><code>setTextSkewX(float skewX);</code></p>
</li>
<li><p>设置Typeface对象,即字体风格,包括粗体,斜体以及衬线体,非衬线体等。<br><code>setTypeface(Typeface typeface);</code></p>
</li>
<li><p>设置带有下划线的文字效果。<br><code>setUnderlineText(boolean underlineText);</code></p>
</li>
<li><p>设置带有删除线的效果。<br><code>setStrikeThruText(boolean strikeThruText);</code></p>
</li>
<li><p>设置是否打开线性文本标识。<br><code>setLinearText (boolean linearText)</code></p>
</li>
<li><p>设置地理位置,直接传入Locale.getDefault()。<br><code>setTextLocale (Locale locale)</code></p>
</li>
<li><p>设置字体的样式,样式可以为null。<br><code>setFontFeatureSettings(String settings)</code></p>
</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Paint即画笔,在绘图过程中起到了极其重要的作用,画笔主要保存了颜色，  &lt;/p&gt;
&lt;p&gt;样式等绘制信息,指定了如何绘制文本和图形,画笔对象有很多设置方法，  &lt;/p&gt;
&lt;p&gt;大体上可以分为两类,一类与图形绘制相关,一类与文本绘制相关. &lt;/p&gt;
    
    </summary>
    
      <category term="Android 绘图" scheme="http://jkwarthegarden.com/categories/Android-%E7%BB%98%E5%9B%BE/"/>
    
    
      <category term="Paint" scheme="http://jkwarthegarden.com/tags/Paint/"/>
    
  </entry>
  
  <entry>
    <title>Service 详解</title>
    <link href="http://jkwarthegarden.com/2015/12/12/Android%20Service%20%E8%AF%A6%E8%A7%A3/"/>
    <id>http://jkwarthegarden.com/2015/12/12/Android Service 详解/</id>
    <published>2015-12-11T17:34:14.000Z</published>
    <updated>2017-04-18T15:24:23.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Service-简介"><a href="#Service-简介" class="headerlink" title="Service 简介"></a>Service 简介</h3><p>Service作为Android四大组件之一，在每一个应用程序中都扮演着非常重要的角色。它主要用于在后台处理一些耗时的逻辑，或者去执行某些需要长期运行的任务。必要的时候我们甚至可以在程序退出的情况下，让Service在后台继续保持运行状态。</p>
<h3 id="Service-生命周期图"><a href="#Service-生命周期图" class="headerlink" title="Service 生命周期图"></a>Service 生命周期图</h3><p><img src="http://oglc61v4u.bkt.clouddn.com/service_lifecycle.png" alt=""></p>
<ul>
<li><p>onStartCommand()<br>当使用StartService()启动服务时,系统会调用此方法,一旦执行此方法,服务将会启动,并在后台无限运行,如果您实现此方法，则在服务工作完成后，需要由您通过调用 stopSelf() 或 stopService() 来停止服务.</p>
</li>
<li><p>onBind()<br>当使用BindService()启动服务时，系统会调用此方法，在此方法中，您必须通过返回 IBinder 提供一个接口，供客户端用来与服<br>务进行通信，如果你不希望绑定，则应该返回null。</p>
</li>
<li><p>onCreate()<br>首次创建服务时，系统会调用此方法来执行初始化操作（在调用 onStartCommand() 或 onBind() 之前)，如果服务已经运行,则不<br>会调用此方法。</p>
</li>
<li><p>onDestroy()<br>当服务不再使用且被销毁时，系统调用此方法，服务应该实现此方法来清理所有资源，如线程、注册的侦听器、接收器等。</p>
</li>
</ul>
<a id="more"></a>  
<ol>
<li><p>左图：是使用startService启动的服务生命周期，它启动的服务绘制后台运行，与Activity没有关联。</p>
</li>
<li><p>右图：是使用bindService启动的服务生命周期，它启动的服务会和Activity绑定，Activity销毁Service也会随之销毁。</p>
</li>
</ol>
<h3 id="前台-Service"><a href="#前台-Service" class="headerlink" title="前台 Service"></a>前台 Service</h3><p>前台服务与后台服务相比：它有一个一直在运行的图标在系统的状态栏显示，下拉菜单栏后可以看到更清楚的信息，非常类似通知效果。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">//前台服务</div><div class="line">Intent intent = new Intent(this, MainActivity.class);</div><div class="line">PendingIntent pi = PendingIntent.getActivity(this, 0, intent, 0);</div><div class="line">Notification notification = new Notification.Builder(this)</div><div class="line">                .setContentTitle(&quot;前台服务标题&quot;)</div><div class="line">                .setContentText(&quot;前台服务内容&quot;)</div><div class="line">                .setWhen(System.currentTimeMillis()) //系统时间</div><div class="line">                .setSmallIcon(R.drawable.ic_stat_name)</div><div class="line">                .setLargeIcon(BitmapFactory.decodeResource(getResources(), R.mipmap.ic_launcher))</div><div class="line">                .setContentIntent(pi)</div><div class="line">                .build();</div><div class="line">//绑定服务</div><div class="line">startForeground(1, notification);</div><div class="line">//关闭前台服务</div><div class="line">stopForeground(false);</div></pre></td></tr></table></figure></p>
<h3 id="远程Service（AIDL）"><a href="#远程Service（AIDL）" class="headerlink" title="远程Service（AIDL）"></a>远程Service（AIDL）</h3><ol>
<li><p>创建AIDL接口<br><img src="http://oglc61v4u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-04-18%2014.36.39.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">interface IRemoteService &#123;</div><div class="line">       //求和</div><div class="line">       int add(int a, int b);</div><div class="line">       //转化</div><div class="line">       String toUpperCase(String str);</div><div class="line">       //保存</div><div class="line">       Person save(in Person person);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里我传递对象所以必须定义与Person同名的AIDL文件，代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">package com.jkwar.serviceExample;</div><div class="line">parcelable Person;</div></pre></td></tr></table></figure>
</li>
<li><p>实现接口<br>实现 Service 并重写 onBind() 以返回 Stub 类的实现。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">private final IRemoteService.Stub mBinder = new IRemoteService.Stub() &#123;</div><div class="line">    @Override</div><div class="line">    public int add(int a, int b) throws RemoteException &#123;</div><div class="line">        Log.d(TAG, &quot;add: executed&quot;);</div><div class="line">        return a + b;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public String toUpperCase(String str) throws RemoteException &#123;</div><div class="line">        Log.d(TAG, &quot;toUpperCase: executed&quot;);</div><div class="line">        return str.toUpperCase();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public Person save(Person person) throws RemoteException &#123;</div><div class="line">        Log.d(TAG, &quot;save: executed&quot;);</div><div class="line">        if (person == null) &#123;</div><div class="line">            return new Person(2, &quot;hello word&quot;);</div><div class="line">        &#125;</div><div class="line">        Log.d(TAG, &quot;Name: &quot; + person.getName());</div><div class="line">        Log.d(TAG, &quot;Id: &quot; + person.getId());</div><div class="line">        return person;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>并在AndroidManifest.xml文件中绑定action</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;service</div><div class="line">       android:name=&quot;.RemoteService&quot;</div><div class="line">       android:enabled=&quot;true&quot;</div><div class="line">       android:exported=&quot;true&quot;</div><div class="line">       android:process=&quot;:remote&quot;&gt;</div><div class="line">       &lt;intent-filter&gt;</div><div class="line">           &lt;action android:name=&quot;com.jkwar.serviceExample.IRemoteService&quot; /&gt;</div><div class="line">       &lt;/intent-filter&gt;</div><div class="line">   &lt;/service&gt;</div></pre></td></tr></table></figure>
<p>process有2种赋值：“:remote” 和 “remote”<br>带有”:”的表示该服务所在的进程是私有的，即只要有客户端去启动该服务，系统就会创建一个新的进程来运行该服务。<br>不带有”:”的表示该服务所在的进程是共享的，即当前系统不管有几个客户端去启动该服务，系统中只有一个进程来运行该服务。</p>
</li>
<li><p>新建名为client的Module，实现Service通讯。<br><img src="http://oglc61v4u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-04-18%2022.24.59.png" alt=""></p>
<p>使用bindService启动服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">private ServiceConnection connection = new ServiceConnection() &#123;</div><div class="line">    @Override</div><div class="line">    public void onServiceConnected(ComponentName name, IBinder service) &#123;</div><div class="line">        iRemoteService = IRemoteService.Stub.asInterface(service);</div><div class="line">        Log.d(TAG, &quot;onServiceConnected: &quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void onServiceDisconnected(ComponentName name) &#123;</div><div class="line">        Log.d(TAG, &quot;onServiceDisconnected: &quot;);</div><div class="line">        iRemoteService = null;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>由于Android 5.0不支持隐式Intent。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//第一种方式</div><div class="line">Intent intent = new Intent(IRemoteService.class.getName());</div><div class="line">intent.setClassName(&quot;com.jkwar.serviceExample&quot;, &quot;com.jkwar.serviceExample.RemoteService&quot;);</div><div class="line">//将隐式启动转换为显示启动</div><div class="line">Intent mIntent = new Intent();</div><div class="line">mIntent.setAction(&quot;com.jkwar.serviceExample.IRemoteService&quot;);</div><div class="line">Intent eintent = new Intent(getExplicitIntent(this,mIntent));</div><div class="line">//绑定服务</div><div class="line">bindService(eintent, connection, BIND_AUTO_CREATE);</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="源码下载"><a href="#源码下载" class="headerlink" title="源码下载"></a>源码下载</h3><p><a href="https://github.com/zhanaotian/ServiceExample" target="_blank" rel="external">ServiceExample</a></p>
<h5 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h5><p><a href="http://blog.csdn.net/guolin_blog/article/details/9797169" target="_blank" rel="external">Android Service完全解析，关于服务你所需知道的一切</a><br><a href="http://blog.csdn.net/guolin_blog/article/details/9797169" target="_blank" rel="external">官方Api</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Service-简介&quot;&gt;&lt;a href=&quot;#Service-简介&quot; class=&quot;headerlink&quot; title=&quot;Service 简介&quot;&gt;&lt;/a&gt;Service 简介&lt;/h3&gt;&lt;p&gt;Service作为Android四大组件之一，在每一个应用程序中都扮演着非常重要的角色。它主要用于在后台处理一些耗时的逻辑，或者去执行某些需要长期运行的任务。必要的时候我们甚至可以在程序退出的情况下，让Service在后台继续保持运行状态。&lt;/p&gt;
&lt;h3 id=&quot;Service-生命周期图&quot;&gt;&lt;a href=&quot;#Service-生命周期图&quot; class=&quot;headerlink&quot; title=&quot;Service 生命周期图&quot;&gt;&lt;/a&gt;Service 生命周期图&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;http://oglc61v4u.bkt.clouddn.com/service_lifecycle.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;onStartCommand()&lt;br&gt;当使用StartService()启动服务时,系统会调用此方法,一旦执行此方法,服务将会启动,并在后台无限运行,如果您实现此方法，则在服务工作完成后，需要由您通过调用 stopSelf() 或 stopService() 来停止服务.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;onBind()&lt;br&gt;当使用BindService()启动服务时，系统会调用此方法，在此方法中，您必须通过返回 IBinder 提供一个接口，供客户端用来与服&lt;br&gt;务进行通信，如果你不希望绑定，则应该返回null。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;onCreate()&lt;br&gt;首次创建服务时，系统会调用此方法来执行初始化操作（在调用 onStartCommand() 或 onBind() 之前)，如果服务已经运行,则不&lt;br&gt;会调用此方法。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;onDestroy()&lt;br&gt;当服务不再使用且被销毁时，系统调用此方法，服务应该实现此方法来清理所有资源，如线程、注册的侦听器、接收器等。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Service" scheme="http://jkwarthegarden.com/categories/Service/"/>
    
    
      <category term="Service 详解" scheme="http://jkwarthegarden.com/tags/Service-%E8%AF%A6%E8%A7%A3/"/>
    
  </entry>
  
  <entry>
    <title>Activity Task 相关</title>
    <link href="http://jkwarthegarden.com/2015/11/29/Activity%20Task%E7%9B%B8%E5%85%B3/"/>
    <id>http://jkwarthegarden.com/2015/11/29/Activity Task相关/</id>
    <published>2015-11-28T19:54:45.000Z</published>
    <updated>2017-04-09T07:34:53.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Android-任务栈简介"><a href="#Android-任务栈简介" class="headerlink" title="Android 任务栈简介"></a>Android 任务栈简介</h3><blockquote>
<p>在Android 系统中，通过栈结构来保存整个APP的Activity，栈的结构是先进先出（Last In First Out）的线性表，当一个Activity启动另外一个Activity的时候，新启动的Activity就会置于任务栈的顶端，并处于活动状态,而启动它的Activity依然保持在任务栈中，处于停止状态，当用户按下返回键或者调用Finish方法时，系统会移除顶部的Activity，让后面的Activity回复活动状态。当然，这里也有特权阶级，就是在AndroidManinifest文件中的属性android：launchMode来设置或者通过Intent的flag来设置。</p>
</blockquote>
<p><img src="http://oglc61v4u.bkt.clouddn.com/Activity%E4%BB%BB%E5%8A%A1%E5%A0%86%E6%A0%88.png" alt=""></p>
 <a id="more"></a>  
<h3 id="AndroidMainifest启动模式"><a href="#AndroidMainifest启动模式" class="headerlink" title="AndroidMainifest启动模式"></a>AndroidMainifest启动模式</h3><blockquote>
<p>Android 的启动模式一个有四种，分别是standard、singleTop、singleTask、singleStance，具有不同的功能。</p>
</blockquote>
<ol>
<li><p>standard<br>默认启动模式，每次激活Activity都会创建新的实例，并放入任务栈中。<br>使用场景：大多数的Activity。</p>
</li>
<li><p>singleTop<br>如果在任务的栈顶正好存在该Activity的实例，就重用该实例(会调用实例的onNewIntent())，否则就会创建新的实例并放入栈顶，即使栈中已经存在该Activity的实例，只要不在栈顶，都会创建新的实例。<br>使用场景：接受消息后显示的界面（新闻类和阅读类App的内容界面）。</p>
</li>
<li><p>singleTask<br>如果在栈中已经有该Activity的实例，就重用该实例(会调用实例的onNewIntent())。重用时，会让该实例回到栈顶，因此在它上面的实例将会被移出栈。如果栈中不存在该实例，将会创建新的实例放入栈中。<br>使用场景：浏览器的主界面或者退出整个应用。浏览器的主界面：不管从多少个应用启动浏览器，只会启动主界面一次，其余情况都会走onNewIntent，并且会清空主界面上面的其他页面。退出整个应<br>用：将主Activity设为SingleTask模式，然后在要退出的Activity中转到主Activity，从而将主Activity之上的Activity都清除，然后重写主Activity的onNewIntent方法，在方法中加上一句finish(),<br>将最后一个Activity结束掉。</p>
</li>
<li><p>singleStance<br>在一个新栈中创建该Activity的实例，并让多个应用共享该栈中的该Activity实例。一旦该模式的Activity实例已经存在于某个栈中，任何应用再激活该Activity时都会重用该栈中的实例( 会调用实例的 onNewIntent() )。其效果相当于多个应用共享一个应用，不管谁激活该 Activity 都会进入同一个应用中。<br>使用场景：如闹铃提醒，将闹铃提醒与闹铃设置分离。singleInstance不要用于中间页面，如果用于中间页面，跳转会有问题，比如：A -&gt; B (singleInstance) -&gt; C，完全退出后，在此启动，首先打开的是B。</p>
</li>
</ol>
<blockquote>
<p>注意：如果在一个singleTask和singleStance的ActivityA中通过startActivityResult()方法启动另外一个ActivityB，那么系统会直接方法Activity.RESULT_CANCELED而不会再去等待方法。这是游戏系统在Framework层做了限制，所以二种不同Task之间，默认是不能传递数据的，如果一定要传递，那就只能通过Intent来绑定数据。</p>
</blockquote>
<h3 id="Intent-Flag-启动模式"><a href="#Intent-Flag-启动模式" class="headerlink" title="Intent Flag 启动模式"></a>Intent Flag 启动模式</h3><ul>
<li><p>Intent.FLAG_ACTIVITY_NEW_TASK（默认）</p>
<p>使用一个新的Task来启动一个Activity，但启动的每个Activity都将在一个新的Task，该Flag通常使用在从Service中启动Activity的场景，由于Service中并不存在Activity栈，所以使用该Flag来创建一个新的Activity栈，并创建新的Activity实例。</p>
</li>
<li><p>Intent.FLAG_ACTIVITY_SINGLE_TOP</p>
<p>使用singletop模式来启动一个Activity，与指定android：launchMode=”singleTop“效果相同。</p>
</li>
<li><p>Intent.FLAG_ACTIVITY_CLEAR_TOP</p>
<p>如果设置，并且这个Activity已经在当前的Task中运行，因此，不再是重新启动一个这个Activity的实例，而是在这个Activity上方的所有Activity都将关闭，然后这个Intent会作为一个新的I ntent投递到老的Activity（现在位于顶端）中。<br>例如：假设一个Task中包含这些Activity：A，B，C，D。如果D调用了startActivity()，并且包含一个指向Activity B的Intent，那么，C和D都将结束，然后B接收到这个Intent，因此，目前stack的状况是：A，B。</p>
</li>
<li><p>Intent.FLAG_ACTIVITY_NO_HISTORY</p>
<p>如果设置，这将在Task的Activitystack中设置一个还原点，当Task恢复时，需要清理Activity。也就是说，下一次Task带着 FLAG_ACTIVITY_RESET_TASK_IF_NEEDED标记进入前台时（典型的操作是用户在主画面重启它），这个Activity和它之上的都将关闭，以至于用户不能再返回到它们，但是可以回到之前的Activity。<br>例如，一个e-mail应用程序可能有一个操作是查看一个附件，需要启动图片浏览Activity来显示。这个 Activity应该作为e-mail应用程序Task的一部分，因为这是用户在这个Task中触发的操作。然而，当用户离开这个Task，然后从主画面选择e-mail app，我们可能希望回到查看的会话中，但不是查看图片附件，因为这让人困惑。通过在启动图片浏览时设定这个标志，浏览及其它启动的Activity在下次用户返回到mail程序时都将全部清除。</p>
</li>
<li><p>Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED<br>在重置Task或者启动Activity创建新的Task时生效。</p>
</li>
<li><p>Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET</p>
<p>使用这种模式启动Activity，重置该Task时清除该Activity。<br>例如：A以这种模式启动B，B又启动C，当用户离开应用，一段时间后又从Home回到应用，显示A界面，当前Activity栈为A。</p>
</li>
<li><p>Intent.FLAG_ACTIVITY_REORDER_TO_FRONT</p>
<p>如果在Intent中设置，并传递给Context.startActivity()，这个标志将引发已经运行的Activity移动到历史stack的顶端。<br>例如：假设一个Task由四个Activity组成：A,B,C,D。如果D调用startActivity()来启动Activity B，那么，B会移动到历史stack的顶端，现在的次序变成A,C,D,B。如果FLAG_ACTIVITY_CLEAR_TOP标志也设置的话，那么这个标志将被忽略。</p>
</li>
<li><p>Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS</p>
<p>如果设置，新的Activity不会在最近启动的Activity的列表中保存。</p>
</li>
<li><p>Intent.FLAG_ACTIVITY_FORWARD_RESULT</p>
<p>如果设置，并且这个Intent用于从一个存在的Activity启动一个新的Activity，那么，这个作为答复目标的Activity将会传到这个新的Activity中。这种方式下，新的Activity可以调用setResult(int)，并且这个结果值将发送给那个作为答复目标的 Activity。</p>
</li>
</ul>
<h3 id="清空任务栈"><a href="#清空任务栈" class="headerlink" title="清空任务栈"></a>清空任务栈</h3><p>  系统提供清空任务栈的方法让我让我们将一个Task清除。通常情况下，我们在AndroidMainifest文件中的<activity>标签中使用以下几种属性来清理任务栈。</activity></p>
<ul>
<li><p>clearTaskOnLaunch</p>
<p>每次返回该Activity时，都将该Activity之上的所有Activity清除，通过这个属性，可以让这个Task每次在初始化的时候，都只 有这个Activity。</p>
<ul>
<li>finishOnTaskLaunch</li>
</ul>
<p>finishOnTaskLaunch属性与clearTaskOnLaunch类似，只不过finishOnTaskLaunch是作业在自己身上，通过这个属性，当离开这个Activity所在的Task，那么用户返回时，该Activity就会被finish掉。</p>
</li>
</ul>
<ul>
<li><p>alwaysRetainTaskState</p>
<p>alwayRetainTaskState属性给Task设置免死金牌，如果如果将Activity的这个属性设置为True，那么该Activity所在的Task将不接受任何清理命令，一直保持当前Task状态。</p>
</li>
<li><p>allowTaskReparenting</p>
<p>Activity实例在当前应用退居后台后，是否能从启动它的那个task移动到有共同affinity的task，“true”表示可以移动，“false”表示它必须呆在当前应用的task中，默认值为false。</p>
</li>
</ul>
<h5 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h5><p>(<a href="http://blog.csdn.net/liuhe688/article/details/6761337" target="_blank" rel="external">http://blog.csdn.net/liuhe688/article/details/6761337</a>)<br>(<a href="https://my.oschina.net/u/2336511/blog/392412" target="_blank" rel="external">https://my.oschina.net/u/2336511/blog/392412</a>)</p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Android-任务栈简介&quot;&gt;&lt;a href=&quot;#Android-任务栈简介&quot; class=&quot;headerlink&quot; title=&quot;Android 任务栈简介&quot;&gt;&lt;/a&gt;Android 任务栈简介&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;在Android 系统中，通过栈结构来保存整个APP的Activity，栈的结构是先进先出（Last In First Out）的线性表，当一个Activity启动另外一个Activity的时候，新启动的Activity就会置于任务栈的顶端，并处于活动状态,而启动它的Activity依然保持在任务栈中，处于停止状态，当用户按下返回键或者调用Finish方法时，系统会移除顶部的Activity，让后面的Activity回复活动状态。当然，这里也有特权阶级，就是在AndroidManinifest文件中的属性android：launchMode来设置或者通过Intent的flag来设置。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;http://oglc61v4u.bkt.clouddn.com/Activity%E4%BB%BB%E5%8A%A1%E5%A0%86%E6%A0%88.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Activity" scheme="http://jkwarthegarden.com/categories/Activity/"/>
    
    
      <category term="Activity Task" scheme="http://jkwarthegarden.com/tags/Activity-Task/"/>
    
  </entry>
  
  <entry>
    <title>Activity 生命周期</title>
    <link href="http://jkwarthegarden.com/2015/10/10/Actvitiy%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"/>
    <id>http://jkwarthegarden.com/2015/10/10/Actvitiy 生命周期/</id>
    <published>2015-10-09T17:34:14.000Z</published>
    <updated>2017-04-09T08:05:52.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Activity-生命周期是什么？"><a href="#Activity-生命周期是什么？" class="headerlink" title="Activity 生命周期是什么？"></a>Activity 生命周期是什么？</h3><blockquote>
<p>Activity生命周期是为了更好的管理Activty的一套规则，它可以在多种形态之间进行切换，以此来适应不同的要求。</p>
</blockquote>
<h3 id="Activity-形态"><a href="#Activity-形态" class="headerlink" title="Activity 形态"></a>Activity 形态</h3><ul>
<li><p>Activity/Running<br>该状态下，Activity处于Activity栈的最顶层，可见，并可以与用户进行交互。</p>
</li>
<li><p>Paused<br>该状态下，Activity失去焦点，被另外一个非全屏或者通明的Activity所遮盖，Activity就会进入Paused形态，但是它只是失去与用户交互的能力，所有的状态信息，成员变量都还保持着，只有在系统内存极低的情况下，才会被系统回收掉。</p>
</li>
<li><p>Stopped<br>该状态下，Activity被另外一个Activity完全覆盖，Activity就会进入Stopped形态，此时它不再可见，但是所有的状态信息，成员变量都还保存着。</p>
</li>
<li><p>Killed<br>当Activity被系统回收掉或者Activity从来没有创建过，那么Activity就会处于Killed状态。</p>
</li>
</ul>
<p>由此可见，用户的不同动作，会让Activity在这四种形态将切换，而开发者，虽然可以控制Activity如何生，却无法控制Activity如何死。</p>
 <a id="more"></a>  
<h3 id="生命周期图"><a href="#生命周期图" class="headerlink" title="生命周期图"></a>生命周期图</h3><blockquote>
<p>谷歌给我们一张图来揭示Activity的生命周期，它希望Activity的生命周期能被开发者所控制，而不是一匹脱缰的野马。</p>
</blockquote>
<p><img src="http://hukai.me/android-training-course-in-chinese/basics/activity-lifecycle/basic-lifecycle.png" alt=""></p>
<blockquote>
<p>开发者不必实现所有的生命周期方法，但是我们必须知道每个生命周期状态的含义，可以让我们更好的掌控Activity，让它能更好的完成你所期待的效果。<br>虽然有很多的Activity的生命周期状态，但是其中只有三种状态是稳定的，而其他状态都是过渡状态，很快就会结束。</p>
</blockquote>
<ul>
<li><p>Running<br>该状态下，Activity处于Activity栈顶，用户可以与它交互。</p>
</li>
<li><p>Paused<br>当Activity被遮盖时进入这个状态，此时，它不再接受用户输入。</p>
</li>
<li><p>Stopped<br>当Activity完全被覆盖是进入这个状态，此时它不可见，仅在后台运行。</p>
</li>
</ul>
<h4 id="启动与销毁Activity的过程"><a href="#启动与销毁Activity的过程" class="headerlink" title="启动与销毁Activity的过程"></a>启动与销毁Activity的过程</h4><blockquote>
<p>在系统调用onCreate()之后,就马上调用onStart(),之后再调用onResume()，最后停留在Resumed状态，完成启动。系统调用onDestroy()销毁Activity生命周期让它回到Killed形态。</p>
</blockquote>
<p>以上过程就是Activity的启动与销毁过程。</p>
<ul>
<li><p>onCreate()：声明UI元素，定义成员变量，配置UI等（onCreate里面尽量少做事情，避免程序启动太久都看不到界面）。</p>
</li>
<li><p>onDestory()：因为引用会在Activity销毁的时候销毁，而线程不会，如果activity含有在onCreate调用时创建的后台线程，或者是其他有可能导致内存泄漏的资源，则应该在OnDestroy()时进行资源清理，杀死后台线程。</p>
</li>
</ul>
<h4 id="暂停与恢复Activity的过程"><a href="#暂停与恢复Activity的过程" class="headerlink" title="暂停与恢复Activity的过程"></a>暂停与恢复Activity的过程</h4><blockquote>
<p>当Activity被其他组件阻塞时部分不可见，就会导致当前Activity进入Pause状态，此时系统就会调用activity中的onPause()方法。当阻塞结束后，就会调用onResume()方法恢复到Resumed状态。</p>
</blockquote>
<p>以上过程就是Activity的暂停与恢复过程。</p>
<ul>
<li><p>onPause()：释放系统资源（如broadcast receivers, sensors，Camera等）、停止动画或者是其他正在运行的操作。</p>
</li>
<li><p>onResume()：重新初始化那些在 onPause()中释放的资源，并执行一些停止的操作（如开启动画）。</p>
</li>
</ul>
<h4 id="停止与重启Activity的过程"><a href="#停止与重启Activity的过程" class="headerlink" title="停止与重启Activity的过程"></a>停止与重启Activity的过程</h4><blockquote>
<p>当Activity部分不可见时，有2种可能，从部分不可见到可见，系统调用onResume()恢复到Resumed状态；从部分不可见到完全不可见，系统调用onStop()停止Activity进入Stopped状态，注意无论什么原因导致Activity停止，系统总是会在onStop()之前调用onPause()方法。当activity从Stopped状态回到前台时，系统调用onRestart()，马上调用onStart()，之后再执行onResume()。</p>
</blockquote>
<p>以上过程就是Activity停止和重启启动过程。</p>
<ul>
<li><p>onStop()：释放系统资源（在极端情况下，系统会直接杀死我们的app进程，并不执行activity的onDestroy()回调方法，所以要在这些释放系统资源，避免内存泄漏）、执行那些CPU intensive的shut-down操作，例如往数据库写信息。</p>
</li>
<li><p>onStart()：重新初始化那些在 onStop()中释放的资源。</p>
</li>
</ul>
<h4 id="重新创建Activity"><a href="#重新创建Activity" class="headerlink" title="重新创建Activity"></a>重新创建Activity</h4><blockquote>
<p>如果系统长时间处于stopped形态而且此时系统需要更多内存或者系统内存极为紧张时，系统会回收你的Activity，而此时系统会将Actvity状态通过onSaveInstanceState() 方法保存到Bundle对象中，当然我们可以通过增加额外的键值对的集合来保存状态信息，比如在 EditText 组件中的文本或 ListView的滑动位置。当我们需<br>要重新创建Activity的时候，保存的Bundle对象会传递到Activity的onRestoreInstanceState() 方法和onCreate()方法中。</p>
</blockquote>
<p><img src="http://hukai.me/android-training-course-in-chinese/basics/activity-lifecycle/basic-lifecycle-savestate.png" alt=""></p>
<p>由于 onCreate() 方法会在第一次创建新的Activity实例与重新创建之前被Destory的实例时都被调用，我们必须在尝试读取 Bundle 对象前检测它是否为null。如果它为null，系统则是创建一个新的Activity实例，而不是恢复之前被Destory的Activity。</p>
<p>onRestoreInstanceState()方法会在 onStart() 方法之后执行. 系统仅仅会在存在需要恢复的状态信息时才会调用 onRestoreInstanceState() ，因此不需要检查 Bundle 是否为null。</p>
<h3 id="横竖屏切换时Android-生命周期"><a href="#横竖屏切换时Android-生命周期" class="headerlink" title="横竖屏切换时Android 生命周期"></a>横竖屏切换时Android 生命周期</h3><ul>
<li><p>不设置Activity的android:configChanges时，切屏会重新调用各个生命周期，切横屏时会执行一次，切竖屏时会执行两次。</p>
</li>
<li><p>设置Activity的android:configChanges=”orientation”时，切屏还是会重新调用各个生命周期，切横、竖屏时只会执行一次。</p>
</li>
<li><p>设置Activity的android:configChanges=”orientation|keyboardHidden”时，切屏不会重新调用各个生命周期，只会执行onConfigurationChanged方法。</p>
</li>
</ul>
<h5 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h5><p><a href="http://blog.csdn.net/eclipsexys/article/details/47405045" target="_blank" rel="external">Android 群英传</a><br><a href="https://developer.android.google.cn/training/index.html" target="_blank" rel="external">Android官方培训</a><br><a href="https://developer.android.google.cn/reference/android/app/Activity.html" target="_blank" rel="external">Activity Api</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Activity-生命周期是什么？&quot;&gt;&lt;a href=&quot;#Activity-生命周期是什么？&quot; class=&quot;headerlink&quot; title=&quot;Activity 生命周期是什么？&quot;&gt;&lt;/a&gt;Activity 生命周期是什么？&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;Activity生命周期是为了更好的管理Activty的一套规则，它可以在多种形态之间进行切换，以此来适应不同的要求。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;Activity-形态&quot;&gt;&lt;a href=&quot;#Activity-形态&quot; class=&quot;headerlink&quot; title=&quot;Activity 形态&quot;&gt;&lt;/a&gt;Activity 形态&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Activity/Running&lt;br&gt;该状态下，Activity处于Activity栈的最顶层，可见，并可以与用户进行交互。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Paused&lt;br&gt;该状态下，Activity失去焦点，被另外一个非全屏或者通明的Activity所遮盖，Activity就会进入Paused形态，但是它只是失去与用户交互的能力，所有的状态信息，成员变量都还保持着，只有在系统内存极低的情况下，才会被系统回收掉。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Stopped&lt;br&gt;该状态下，Activity被另外一个Activity完全覆盖，Activity就会进入Stopped形态，此时它不再可见，但是所有的状态信息，成员变量都还保存着。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Killed&lt;br&gt;当Activity被系统回收掉或者Activity从来没有创建过，那么Activity就会处于Killed状态。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;由此可见，用户的不同动作，会让Activity在这四种形态将切换，而开发者，虽然可以控制Activity如何生，却无法控制Activity如何死。&lt;/p&gt;
    
    </summary>
    
      <category term="Activity" scheme="http://jkwarthegarden.com/categories/Activity/"/>
    
    
      <category term="Activity 生命周期" scheme="http://jkwarthegarden.com/tags/Activity-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"/>
    
  </entry>
  
</feed>
